<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Part II Computational Physics - 7&nbsp; Algorithms and computational complexity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./fourier.html" rel="next">
<link href="./monte-carlo.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Algorithms and computational complexity</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Part II Computational Physics</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Going</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numpy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">NumPy and friends</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numbers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Floating point and all that</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ode.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Solving differential equations with SciPy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monte-carlo.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Monte Carlo methods</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complexity.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Algorithms and computational complexity</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fourier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Fast Fourier Transform</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linear.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Linear algebra</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./divide.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Divide and Conquer</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dynamic Programming</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./autograd.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Automatic Differentiation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Summary</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#first-example-multiplication" id="toc-first-example-multiplication" class="nav-link active" data-scroll-target="#first-example-multiplication"><span class="toc-section-number">7.1</span>  First example: multiplication</a></li>
  <li><a href="#defining-complexity" id="toc-defining-complexity" class="nav-link" data-scroll-target="#defining-complexity"><span class="toc-section-number">7.2</span>  Defining complexity</a>
  <ul class="collapse">
  <li><a href="#best-worst-average" id="toc-best-worst-average" class="nav-link" data-scroll-target="#best-worst-average"><span class="toc-section-number">7.2.1</span>  Best / worst / average</a></li>
  <li><a href="#polynomial-complexity" id="toc-polynomial-complexity" class="nav-link" data-scroll-target="#polynomial-complexity"><span class="toc-section-number">7.2.2</span>  Polynomial complexity</a></li>
  <li><a href="#better-than-linear" id="toc-better-than-linear" class="nav-link" data-scroll-target="#better-than-linear"><span class="toc-section-number">7.2.3</span>  Better than linear?</a></li>
  <li><a href="#exponential-complexity" id="toc-exponential-complexity" class="nav-link" data-scroll-target="#exponential-complexity"><span class="toc-section-number">7.2.4</span>  Exponential complexity</a></li>
  </ul></li>
  <li><a href="#examples-of-different-complexities" id="toc-examples-of-different-complexities" class="nav-link" data-scroll-target="#examples-of-different-complexities"><span class="toc-section-number">7.3</span>  Examples of different complexities</a></li>
  <li><a href="#sorted" id="toc-sorted" class="nav-link" data-scroll-target="#sorted"><span class="toc-section-number">7.4</span>  Sorted</a></li>
  <li><a href="#the-importance-of-data-structures" id="toc-the-importance-of-data-structures" class="nav-link" data-scroll-target="#the-importance-of-data-structures"><span class="toc-section-number">7.5</span>  The importance of data structures</a></li>
  <li><a href="#divide-and-conquer" id="toc-divide-and-conquer" class="nav-link" data-scroll-target="#divide-and-conquer"><span class="toc-section-number">7.6</span>  Divide and conquer</a></li>
  <li><a href="#space-vs.-time-complexity" id="toc-space-vs.-time-complexity" class="nav-link" data-scroll-target="#space-vs.-time-complexity"><span class="toc-section-number">7.7</span>  Space vs.&nbsp;time complexity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Algorithms and computational complexity</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="first-example-multiplication" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="first-example-multiplication"><span class="header-section-number">7.1</span> First example: multiplication</h2>
<p>How hard is it to multiply numbers? The bigger they are, the harder it is, as you well know. You also know that computers are very good at multiplying, so once you’ve switched from multiplying numbers yourself to multiplying them on a computer, you may well be tempted to forget about how hard it is. Nevertheless, computers find big numbers harder than small numbers. How much harder?</p>
<p>If you remember how you learnt to multiply numbers at school, it probably went something like this: <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<table class="table">
<caption>Multiplying two 3 digit numbers</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>×</th>
<th><p>1</p>
<p>3</p></th>
<th><p>2</p>
<p>2</p></th>
<th><p>3</p>
<p>1</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>_</p>
<p>_</p>
<p>3</p></td>
<td><p>_</p>
<p>2</p>
<p>6</p></td>
<td><p>1</p>
<p>4</p>
<p>9</p></td>
<td><p>2</p>
<p>6</p></td>
<td>3</td>
</tr>
<tr class="even">
<td>3</td>
<td>9</td>
<td>4</td>
<td>8</td>
<td>3</td>
</tr>
</tbody>
</table>
<p>For <span class="math inline">\(n\)</span> digits we have to perform <span class="math inline">\(n^2\)</span> single digit multiplications. We then have to add together the <span class="math inline">\(n\)</span> resulting <span class="math inline">\(n\)</span>-digit numbers. This is another <span class="math inline">\(n^2\)</span> operations. Thus the overall number of operations is proportional to <span class="math inline">\(n^2\)</span>: doubling the number of digits will make the problem four times harder.</p>
<p>Exactly how long this takes to perform in your head or on a computer will depend on many things, such as how long it takes you to multiply two digits, or get the previous values out of memory (or read them of the page), but you can’t get away from the basic quadratic scaling law of this algorithm.</p>
</section>
<section id="defining-complexity" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="defining-complexity"><span class="header-section-number">7.2</span> Defining complexity</h2>
<p>When computer scientists talk about the complexity of a problem, this question of <em>scaling of the number of steps involved</em> is what they have in mind. The complexity of any particular task (or calculation) may vary considerably — evaluating <span class="math inline">\(100\times 100\)</span> is considerably easier than the general case, for example — so instead we ask about how a particular <em>general</em> algorithm performs on a <em>class</em> of tasks. Such a class is what computer scientists mean when they talk about a problem: multiplication of <span class="math inline">\(n\)</span> digit numbers is a <em>problem</em>, and any particular pair of <span class="math inline">\(n\)</span> digit numbers represents an <em>instance</em> of that problem. What we discussed above is a particular algorithm for multiplication that has <em>quadratic complexity</em>, or “<span class="math inline">\(O(n^2)\)</span> complexity” (say “order <span class="math inline">\(n\)</span> squared”).</p>
<p>This description only keeps track of how the difficulty scales with the size of the problem. There are various reasons why this level of detail is important:</p>
<ol type="1">
<li><p>It allows us to gloss over what exactly we mean by a <em>step</em>. Are we working in base ten or binary? Looking the digit multiplications up in a table or doing them from scratch?</p></li>
<li><p>Likewise we don’t have to worry about how the algorithm is implemented exactly in software or hardware, what language we use, and so on.</p></li>
<li><p>Inevitably, we always want to look at harder and harder problems with bigger and bigger <span class="math inline">\(n\)</span> (whatever <span class="math inline">\(n\)</span> means for the problem at hand). If a simulation finishes for a system of length 10 we immediately want to run it again for length 20, and so on. It then becomes important to know whether our code is going to run for twice as long, four times as long, or <span class="math inline">\(2^{10}\)</span> times as long (exponential scaling).</p></li>
</ol>
<section id="best-worst-average" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="best-worst-average"><span class="header-section-number">7.2.1</span> Best / worst / average</h3>
<p>Even when we focus on a problem in the above sense we still have to be careful in defining the complexity of an algorithm. In general we can characterize three complexities: best case, worse case, and average case. To see the difference between these three consider <em>search</em>, the very simple problem of finding an item in an (unordered) list of length <span class="math inline">\(n\)</span>. How hard is this? You have to check every item until you find the one you are looking for, so this suggests the complexity is <span class="math inline">\(O(n)\)</span>. You could be lucky and get it first try, however, or within the first ten tries. This means the <em>best case complexity</em> of search is <span class="math inline">\(O(1)\)</span>: it doesn’t increase with the size of the problem. The worst thing that could happen is that the sought item is last: the <em>worst case complexity</em> is <span class="math inline">\(O(n)\)</span>. On average, you’ll find your item in the middle of the list on attempt <span class="math inline">\(\sim n/2\)</span>, so the <em>average case complexity</em> is <span class="math inline">\(O(n/2)\)</span>. But this is the same as <span class="math inline">\(O(n)\)</span> (constants don’t matter)</p>
<p>Thus for <em>linear search</em> we have:</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>Complexity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Best case</td>
<td><span class="math inline">\(O(1)\)</span></td>
</tr>
<tr class="even">
<td>Worst case</td>
<td><span class="math inline">\(O(n)\)</span></td>
</tr>
<tr class="odd">
<td>Average case</td>
<td><span class="math inline">\(O(n)\)</span></td>
</tr>
</tbody>
</table>
<p>We can check the average case performance experimentally by using randomly chosen lists: <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> linear_search(x, val):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"Return True if val is in x, otherwise return False"</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> item <span class="kw">in</span> x:</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> item <span class="op">==</span> val:</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create array of problem sizes n we want to test (powers of 2)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">2</span><span class="op">**</span>np.arange(<span class="dv">2</span>, <span class="dv">20</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the array of integers for the largest problem to use in plotting times</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(N[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialise an empty array to stores times for plotting</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>times <span class="op">=</span> []</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Time the search for each problem size</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> N:</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Time search function (repeating 3 times) to find a random integer in x[:n]</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="op">%</span>timeit <span class="op">-</span>q <span class="op">-</span>n4 <span class="op">-</span>r1 <span class="op">-</span>o linear_search(x[:n], np.random.randint(<span class="dv">0</span>, n))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store best case time (best on a randomly chosen problem)</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    times.append(t.best)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<details>
<summary>Code for plot</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot and label the time taken for linear search</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>plt.loglog(N, times, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n$'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$t$ (s)'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show a reference line of O(n)</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>plt.loglog(N, <span class="fl">1e-6</span><span class="op">*</span>N, label<span class="op">=</span><span class="st">'$O(n)$'</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Experimental complexity of linear search"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="complexity_files/figure-html/cell-4-output-1.png" width="600" height="444"></p>
</div>
</div>
<p>The “experimental noise” in these plots arises because we don’t have full control over exactly what our computer is doing at any moment: there are lots of other processes running. Also, it takes a while to reach the linear regime: there is an overhead associated with starting the program that represents a smaller fraction of the overall run time as <span class="math inline">\(n\)</span> increases.</p>
</section>
<section id="polynomial-complexity" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="polynomial-complexity"><span class="header-section-number">7.2.2</span> Polynomial complexity</h3>
<p>Since you’ve already learnt a lot of algorithms in mathematics (even if you don’t think of them this way) it’s very instructive to revisit them through the lens of computational complexity.</p>
<p>Multiplying a <span class="math inline">\(n\)</span>-dimensional vector by a <span class="math inline">\(n\times n\)</span> matrix?</p>
<p><span class="math display">\[
\begin{align}
\sum_{j=1}^n M_{ij}v_j
\end{align}
\]</span></p>
<p>The sum contains <span class="math inline">\(n\)</span> terms, and we have to perform <span class="math inline">\(n\)</span> such sums. Thus the complexity of this operation is <span class="math inline">\(O(n^2)\)</span>.</p>
<p>Likewise, multiplying two <span class="math inline">\(n\times n\)</span> matrices</p>
<p><span class="math display">\[
\sum_{j} A_{ij}B_{jk}
\]</span></p>
<p>involves <span class="math inline">\(n\)</span> terms for each of the <span class="math inline">\(n^2\)</span> assignments of <span class="math inline">\(i\)</span> and <span class="math inline">\(k\)</span>. Complexity: <span class="math inline">\(O(n^3)\)</span></p>
<p>Thus, if you have to calculate something like <span class="math inline">\(M_1 M_2\cdots M_n \mathbf{v}\)</span>, you should <em>not</em> calculate the matrix product first, but instead do it like this</p>
<p><span class="math display">\[
M_1\left(M_2\cdots \left(M_n \mathbf{v}\right)\right)
\]</span></p>
<p><a href="https://en.wikipedia.org/wiki/Computational_complexity_of_mathematical_operations">Wikipedia has a nice summary</a> of computational complexity of common mathematical operations.</p>
<p>If an algorithm has complexity <span class="math inline">\(O(n^p)\)</span> for some <span class="math inline">\(p\)</span> it is generally described as having <em>polynomial complexity</em>. A useful heuristic (which is not 100% reliable) is that if you have <span class="math inline">\(p\)</span> nested loops that range over <span class="math inline">\(\sim n\)</span>, the complexity is <span class="math inline">\(O(n^p)\)</span> (think how you would implement matrix-vector and matrix-matrix multiplication).</p>
</section>
<section id="better-than-linear" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="better-than-linear"><span class="header-section-number">7.2.3</span> Better than linear?</h3>
<p>It seems obvious that for search you can’t do better than linear: you have to look at roughly half the items before you should expect to find the one you’re looking for <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. What if the list is <em>ordered</em>? Any order will do: numerical for numbers, or lexicographic for strings. This extra structure allows us to use an algorithm called <a href="https://en.wikipedia.org/wiki/Binary_search_algorithm">binary search</a> that you may have seen before. The idea is pretty intuitive: look in the middle of the list and see if the item you seek should be in the top half or bottom half. Take the relevant half and divide it in half again to determine which quarter of the list your item is in, and so on. Here’s how it looks in code:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> binary_search(x, val):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Peform binary search on x to find val. If found returns position, otherwise returns None."""</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Intialise end point indices</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    lower, upper <span class="op">=</span> <span class="dv">0</span>, <span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If values is outside of interval, return None </span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="op">&lt;</span> x[lower] <span class="kw">or</span> val <span class="op">&gt;</span> x[upper]:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform binary search</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Compute midpoint index (integer division)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        midpoint <span class="op">=</span> (upper <span class="op">+</span> lower)<span class="op">//</span><span class="dv">2</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Check which side of x[midpoint] val lies, and update midpoint accordingly</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> val <span class="op">&lt;</span> x[midpoint]:</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            upper <span class="op">=</span> midpoint <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> val <span class="op">&gt;</span> x[midpoint]:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>            lower <span class="op">=</span> midpoint <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> val <span class="op">==</span> x[midpoint]:  <span class="co"># found, so return</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> midpoint</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># In this case val is not in list (return None)</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> upper <span class="op">&lt;</span> lower:</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And here’s the performance</p>
<div class="cell" data-execution_count="5">
<details>
<summary>Code for plot</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create array of problem sizes we want to test (powers of 2)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">2</span><span class="op">**</span>np.arange(<span class="dv">2</span>, <span class="dv">24</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creat array and sort</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(N[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.sort(x)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Initlise an empty array to capture time taken</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>times <span class="op">=</span> []</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Time search for different problem sizes</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> N:</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Time search function for finding '2'</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> <span class="op">%</span>timeit <span class="op">-</span>q <span class="op">-</span>n5 <span class="op">-</span>r2 <span class="op">-</span>o binary_search(x[:n], <span class="dv">2</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store average</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    times.append(t.best)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot and label the time taken for binary search</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>plt.semilogx(N, times, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'$n$'</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'$t$ (s)'</span>)</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Change format on y-axis to scientific notation</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>plt.ticklabel_format(style<span class="op">=</span><span class="st">'sci'</span>, axis<span class="op">=</span><span class="st">'y'</span>, scilimits<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Experimental complexity of binary search"</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="complexity_files/figure-html/cell-6-output-1.png" width="577" height="444"></p>
</div>
</div>
<p>Note the axes: the plot is linear-log, so the straight line indicates <em>logarithmic</em> growth of complexity. This makes sense: if the length is a power of 2 i.e.&nbsp;<span class="math inline">\(n=2^p\)</span>, we are going to need <span class="math inline">\(p\)</span> bisections to locate our value. The complexity is <span class="math inline">\(O(\log n)\)</span> (we don’t need to specify the base as overall constants don’t matter).</p>
<p>Here’s another example of logarithm scaling. <em>Exponentiation</em> is the problem of raising a number <span class="math inline">\(b\)</span> (the base) to the <span class="math inline">\(n\)</span>th power. The obvious way is to multiply the number by itself <span class="math inline">\(n\)</span> times. Linear scaling, right? But there’s a quicker way, since</p>
<p><span class="math display">\[
\begin{align}
b^2 &amp;= b\cdot b\\
b^4 &amp;= b^2\cdot b^2\\
b^4 &amp;= b^4\cdot b^4
\end{align}
\]</span></p>
<p>We only have to do <em>three</em> multiplications! Exponentiation by this method is <span class="math inline">\(O(\log n)\)</span>. To handle powers that aren’t a power of <span class="math inline">\(2\)</span>, we do the following</p>
<p><span class="math display">\[
b^n = \begin{cases}
    b^{n/2} \cdot b^{n/2} &amp; \text{if $n$ even} \\
    b \cdot b^{n-1} &amp; \text{if $n$ odd}
\end{cases}
\]</span></p>
<p>Here’s a way to implement this in code.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> exp(b, n):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> exp(b, n <span class="op">//</span> <span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> b <span class="op">*</span> exp(b, n <span class="op">-</span> <span class="dv">1</span>) </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>exp(<span class="dv">2</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>64</code></pre>
</div>
</div>
<p>This implementation is <em>recursive</em>: the function <code>exp(b, n)</code> <em>calls itself</em>. If this seems a bit self-referential, notice that it only calls itself with <em>lower values of the exponent <span class="math inline">\(n\)</span></em>. This process continues until we hit <span class="math inline">\(n=0\)</span>, and 1 is returned by the first part of the <code>if ... else</code>. Any recursive function has to have such a <em>base case</em> to avoid an infinite regress. You’ll know if you haven’t provided one correctly:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> exp_no_base_case(b, n):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> exp_no_base_case(b, n <span class="op">//</span> <span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> b <span class="op">*</span> exp_no_base_case(b, n <span class="op">-</span> <span class="dv">1</span>) </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>exp_no_base_case(<span class="dv">2</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>RecursionError: maximum recursion depth exceeded in comparison</code></pre>
</div>
</div>
<p>One interesting thing about exponentiation is that while it can be done efficiently, the inverse — finding the logarithm — cannot. To make this more precise one has to work with modular arithmetic i.e.&nbsp;do all operations modulo some number <span class="math inline">\(m\)</span>. Then for <span class="math inline">\(b, y=0,\ldots m-1\)</span> we are guaranteed that there is some number <span class="math inline">\(x\)</span> such that <span class="math inline">\(b^x=y\)</span> (this is called the <a href="https://en.wikipedia.org/wiki/Discrete_logarithm">discrete logarithm</a>). Finding this number is hard: there is no known method for computing it efficiently. Certain <a href="https://en.wikipedia.org/wiki/Public-key_cryptography">public-key cryptosystems</a> are based on the difficulty of the discrete log (for carefully chosen <span class="math inline">\(b\)</span>, <span class="math inline">\(m\)</span> and <span class="math inline">\(y\)</span>).</p>
</section>
<section id="exponential-complexity" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="exponential-complexity"><span class="header-section-number">7.2.4</span> Exponential complexity</h3>
<p>While we’re on the subject of recursion, here’s an example that’s often used to introduce the topic: calculating the <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci numbers</a>. Remember that the Fibonacci numbers are this sequence</p>
<p><span class="math display">\[
0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233 ...
\]</span></p>
<p>where each new term is obtained by adding together the previous two</p>
<p><span class="math display">\[
\text{Fib}(n) = \text{Fib}(n-1) + \text{Fib}(n-2)
\]</span></p>
<p>The fact that the value <span class="math inline">\(\text{Fib}(n)\)</span> is defined in terms of lower values of <span class="math inline">\(n\)</span> makes a recursive definition possible</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fib(n):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> n <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> fib(n <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> fib(n <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>fib(<span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>233</code></pre>
</div>
</div>
<p>The first two terms are the base cases (we need two because the recursion refers to two earlier values). While this looks quite cool it’s actually a terrible way of calculating <span class="math inline">\(\text{Fib}(n)\)</span>. Look at the picture below which illustrates the function calls that are made during the evaluation of <span class="math inline">\(\text{Fib}(5)\)</span>. There are huge amounts of duplication!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/fibonacci.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">The recursive tree for calculating Fibonacci numbers. Source: <a href="https://mitp-content-server.mit.edu/books/content/sectbyfn/books_pres_0/6515/sicp.zip/index.html">SICP</a></figcaption><p></p>
</figure>
</div>
<p>The complexity of this algorithm actually grows <em>exponentially</em> with <span class="math inline">\(n\)</span>. Because of the branching structure the algorithm is <span class="math inline">\(O(2^n)\)</span>. Calculating the Fibonacci number the sensible way (i.e.&nbsp;the way you do it in your head) gives an <span class="math inline">\(O(n)\)</span> algorithm.</p>
<p>It would be nice if exponential complexity were only ever the result of poor choices of algorithm. Unfortunately, this is not the case. It’s possible to come up with problems that definitely <em>can’t</em> be solved faster than exponentially: the <a href="https://en.wikipedia.org/wiki/Tower_of_Hanoi">Towers of Hanoi</a> is one famous example. Closer to the hearts of physicists, the simulation of a quantum system with <span class="math inline">\(n\)</span> qubits (a qubit — or <em>quantum bit</em> — is just a computer sciencey word for a spin-1/2) is believed to have complexity <span class="math inline">\(O(2^n)\)</span>, which is a big part of the hype surrounding quantum computers.</p>
<p>There are problems whose solution, once found, is easy to check. The discrete logarithm we mentioned above is one example. Checking involves exponentiation, and exponentiation is <span class="math inline">\(O(\log n)\)</span> in the size of the numbers, or <span class="math inline">\(O(n)\)</span> in the number of digits. The question of whether efficient (i.e.&nbsp;polynomial) algorithms <em>always</em> exist for problems which are easy to check is in fact <em>the</em> outstanding problem in computer science: it’s called <a href="https://en.wikipedia.org/wiki/P_versus_NP_problem">P <em>vs</em> NP</a>, where P is the class of problems with polynomial time algorithms and NP is the class whose solution can be checked in polynomial time. The question is: are these two classes the same or do they differ? That is, are there problems in NP that aren’t in P? I think it’s fair to say that most people with an opinion on the matter think so, but the proof is lacking (and worth a million dollars).</p>
</section>
</section>
<section id="examples-of-different-complexities" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="examples-of-different-complexities"><span class="header-section-number">7.3</span> Examples of different complexities</h2>
<p>A major goal in algorithm design</p>
<p>Hard to overstate how big a deal it is to find a simple algorithm</p>
<p>Summary of asymptotic notation</p>
<p>XKCD plots</p>
</section>
<section id="sorted" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="sorted"><span class="header-section-number">7.4</span> Sorted</h2>
</section>
<section id="the-importance-of-data-structures" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="the-importance-of-data-structures"><span class="header-section-number">7.5</span> The importance of data structures</h2>
<p>Let’s look again at the code for the Wolff algorithm</p>
</section>
<section id="divide-and-conquer" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="divide-and-conquer"><span class="header-section-number">7.6</span> Divide and conquer</h2>
<p><a href="https://en.wikipedia.org/wiki/Karatsuba_algorithm">Karatsuba algorithm</a> nice story</p>
<p><a href="http://www.cs.ru/personal/karatsuba/divcen.pdf">Karatsuba’s account</a></p>
<p><span class="citation" data-cites="karatsuba1995complexity">Karatsuba (<a href="references.html#ref-karatsuba1995complexity" role="doc-biblioref">1995</a>)</span> contains a nice account of the discovery of his algorithm (<a href="http://www.cs.ru/personal/karatsuba/divcen.pdf">online version</a>)</p>
<p>Karatsuba algo</p>
<p>Big O</p>
<p><a href="https://www.sortvisualizer.com/">Visualization of sorting algorithms</a></p>
<p>Simple example from Leetcode</p>
<p>Analaysis of algorithms</p>
<p>Example of finding a unique item in list</p>
<p>Nice examples from Garth Wells</p>
<p>https://github.com/CambridgeEngineering/PartIA-Computing-Michaelmas/blob/main/11%20Complexity.ipynb</p>
<p>Examples of multiplication</p>
<p>Breadth first and depth first</p>
<p>Importance of choosing a data structure to match algorithm</p>
<p>Examples: queue in Wolff. Was there a Numpy-ish way to do this faster? Priority queue in waiting time algo</p>
<p>FFT uses</p>
<p>https://en.wikipedia.org/wiki/Orthogonal_frequency-division_multiplexing</p>
<p>Needleman-Wunsch</p>
<p>Examples</p>
<ol type="1">
<li>Multiplication <a href="https://en.wikipedia.org/wiki/Multiplication_algorithm#Karatsuba_multiplication">Karatsuba</a></li>
<li>Binary search</li>
<li>Linear algebra</li>
<li>Sorting</li>
<li>FFT</li>
<li>Taking powers (SICP). What is <span class="math inline">\(n\)</span> in this case?</li>
<li>Euclidean algorithm (GCD) (SICP)</li>
</ol>
<p>References. Nature of computation, grokking algos</p>
<p>Insertion in a list etc.</p>
</section>
<section id="space-vs.-time-complexity" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="space-vs.-time-complexity"><span class="header-section-number">7.7</span> Space vs.&nbsp;time complexity</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-karatsuba1995complexity" class="csl-entry" role="doc-biblioentry">
Karatsuba, Anatolii Alexeevich. 1995. <span>“The Complexity of Computations.”</span> <em>Proceedings of the Steklov Institute of Mathematics-Interperiodica Translation</em> 211: 169–83.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Sticking with integers<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>I’ve borrowed this example from <a href="https://github.com/CambridgeEngineering/PartIA-Computing-Michaelmas/blob/main/11%20Complexity.ipynb">Garth Wells’ course</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><a href="https://en.wikipedia.org/wiki/Grover%27s_algorithm">Grover’s algorithm</a> for search has <span class="math inline">\(O(\sqrt{n})\)</span> complexity, but there’s a catch: you need a <em>quantum computer</em>, and even then a <span class="math inline">\(\sqrt{n}\)</span> speedup is not going to get you a billion dollars in this economy.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./monte-carlo.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Monte Carlo methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./fourier.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">The Fast Fourier Transform</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>